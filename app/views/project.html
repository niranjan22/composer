<div class="container-fluid">

  <div ng-controller="ProjectCtrl">
  
    <form>
    
      <fieldset>
        <div class="row"> 
          <div class="col-md-9">
          
            <div class="tabs-container">
              <tabset>
                <tab>
                  <tab-heading>
                    Model
                  </tab-heading>
                  <div class="panel-body">
                    
                    <div class="col-md-4">

                      <script type="text/ng-template" id="modelContent.html">
                        <div class="modal-header">
                            <h3 class="modal-title">Model Details</h3>
                        </div>
                        <div class="modal-body">
                          <div class="form-group">
                            <label for="model-name">Model Name</label>
                            <input ng-model="model.name" type="text" class="form-control"  id="model-name" placeholder="Contact" />
                          </div>
              
                        </div>
                        <div class="modal-footer">
                            <button class="btn btn-primary" ng-click="ok()">OK</button>
                            <button class="btn btn-warning" ng-click="cancel()">Cancel</button>
                        </div>
                      </script>

                      <div class="table">
                        <table class="table table-hover">
                          <thead>
                            <tr>
                              <th>Model  <a ng-click="searchModel()"><span class="glyphicon glyphicon-search"></span></a></th>
                              <th><a ng-click="newmodel()"><span class="glyphicon glyphicon-plus"></span></a></th>
                              <th><a ng-click="removeallmodels()"><span class="glyphicon glyphicon-remove"></span></a></th>
                            </tr>
                            <tr ng-show="searchModelValue">
                              <th colspan="3"><input class="form-control" ng-model="q.name" /></th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr ng-repeat="model in project.models | filter: q.name">
                              <td ng-click="selectModel(model, $index)">{{ model.name }}<span class="badge">{{ model.elements.length }}</span></td>
                              <td><a ng-click="openmodel(model, $index)"><span class="glyphicon glyphicon-edit"></span></a></td>
                              <td><a ng-click="deletemodel($index)"><span class="glyphicon glyphicon-trash"></span></a></td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                      
                    </div>

                    <div class="col-md-8">
                      <!-- Single button -->
                        <!-- 
                        <div class="btn-group">
                          <button type="button" class="btn btn-primary">Action</button>
                          <button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <span class="caret"></span>
                            <span class="sr-only">Toggle Dropdown</span>
                          </button>
                          <ul class="dropdown-menu">
                            <li><a ng-click="newelement()">Add Element</a></li>
                            <li><a ng-click="removeelement()">Remove Element</a></li>
                            <li><a ng-click="removeallelements()">Remove all</a></li>
                          </ul>
                        </div> -->

                      <script type="text/ng-template" id="elementContent.html">
                        <div class="modal-header">
                            <h3 class="modal-title">Element Details</h3>
                        </div>
                        <div class="modal-body">

                            <div class="form-group">
                              <label for="element-name">Element Name</label>
                              <input ng-model="element.elementname" type="text" class="form-control" id="element-name" placeholder="Name" />
                            </div>
                            <div class="form-group">
                              <label for="element-type">Element Type</label>
                              <!-- <input ng-model="element.elementtype" type="text" class="form-control" id="element-type" placeholder="String" /> -->
                              <select class="form-control" ng-model="element.elementtype">
                                <option value="String">String</option>
                                <option value="Number">Number</option>
                                <option value="Date">Date</option>
                              </select>
                            </div>

                        </div>
                        <div class="modal-footer">
                            <button class="btn btn-primary" ng-click="ok()">OK</button>
                            <button class="btn btn-warning" ng-click="cancel()">Cancel</button>
                        </div>
                      </script>            
                      <div class="table-responsive">
                        <table class="table table-hover">
                          <thead>
                            <tr>
                              <th>Element Name <a ng-click="searchElement()"><span class="glyphicon glyphicon-search"></span></a></th>
                              <th>Type</th>
                              <th><a ng-click="newelement()"><span class="glyphicon glyphicon-plus"></span></a></th>
                              <th><a ng-click="removeallelements()"><span class="glyphicon glyphicon-remove"></span></a></th>
                            </tr>
                            <tr ng-show="searchElementValue">
                              <th colspan="4"><input class="form-control" ng-model="e.elementname" /></th>
                            </tr>                            
                          </thead>
                          <tbody>
                            <tr ng-repeat="element in selectedModel.elements | filter: e.elementname">
                              <td>{{ element.elementname }}</td>
                              <td>{{ element.elementtype }}</td>
                              <td><a ng-click="editelement(element, $index)"><span class="glyphicon glyphicon-edit"></span></a></td>
                              <td><a ng-click="removeelement($index)"><span class="glyphicon glyphicon-trash"></span></a></td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </div>
                <!-- tab panel body div close-->
                </tab>

                <tab>
                  <tab-heading>
                    Menu
                  </tab-heading>
                  <div class="panel-body">
                  
                    <!-- menu starts here -->
                    <div class="col-md-5">
                      <script type="text/ng-template" id="menuContent.html">
                        <div class="modal-header">
                            <h3 class="modal-title">Menu Details</h3>
                        </div>
                        <div class="modal-body">

                          <div class="form-group">
                            <label for="menu-name">Menu Name</label>
                            <input ng-model="menu.menuname" type="text" class="form-control" id="menu-name" placeholder="" />
                          </div>
                        
                          <div class="form-group">
                            <label for="menu-label">Menu Label</label>
                            <input ng-model="menu.menulabel" type="text" class="form-control" id="menu-label" placeholder="" />
                          </div>
                          
                        </div>
                        <div class="modal-footer">
                            <button class="btn btn-primary" ng-click="ok()">OK</button>
                            <button class="btn btn-warning" ng-click="cancel()">Cancel</button>
                        </div>
                      </script>
                     
                      <div class="table">
                        <table class="table table-hover">
                          <thead>
                            <tr>
                              <th>Menu  <a ng-click="searchMenu()"><span class="glyphicon glyphicon-search"></span></a></th>
                              <th><a ng-click="newmenu()"><span class="glyphicon glyphicon-plus"></span></a></th>
                              <th><a ng-click="removeallmenus()"><span class="glyphicon glyphicon-remove"></span></a></th>
                            </tr>
                            <tr ng-show="searchMenuValue">
                              <th colspan="3"><input class="form-control" ng-model="m.menuname" /></th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr ng-repeat="menu in project.menus | filter: m.menuname">
                              <td ng-click="selectmenu($index)">{{ menu.menulabel }}<span class="badge">{{ menu.submenus.length }}</span></td>
                               <td><a ng-click="editmenu(menu, $index)"><span class="glyphicon glyphicon-edit"></span></a></td>
                              <td><a ng-click="removemenu($index)"><span class="glyphicon glyphicon-trash"></span></a></td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                    </div>
                    
                    <!-- sub-menu starts here -->
                    <div class="col-md-7">
                      <span>{{ selectedmenu.name }}</span>
                      
                      <script type="text/ng-template" id="submenuContent.html">
                        <div class="modal-header">
                            <h3 class="modal-title">Sub-menu Details</h3>
                        </div>
                        <div class="modal-body">

                            <div class="form-group">
                              <label for="main-menu-name">Main Menu Name</label>
                              <input ng-disabled="true" ng-model="submenu.mainmenuname" type="text" class="form-control" id="main-menu-name" placeholder="" />
                            </div>
                            <div class="form-group">
                              <label for="sub-menu-name">Sub Menu Name</label>
                              <input ng-model="submenu.submenuname" type="text" class="form-control" id="sub-menu-name" placeholder="" />
                            </div>                            
                            <div class="form-group">
                              <label for="sub-menu-label">Sub Menu Label</label>
                              <input ng-model="submenu.submenulabel" type="text" class="form-control" id="sub-menu-label" placeholder="" />
                            </div>
                            
                        </div>
                        <div class="modal-footer">
                            <button class="btn btn-primary" ng-click="ok()">OK</button>
                            <button class="btn btn-warning" ng-click="cancel()">Cancel</button>
                        </div>
                      </script>

                      <div class="table">
                        <table class="table table-hover">
                          <thead>
                            <tr>
                              <th>Sub Menu Name  <a ng-click="searchSubMenu()"><span class="glyphicon glyphicon-search"></span></a></th>
                              <th>Sub Menu Label</th>
                              <th><a ng-click="newsubmenu()"><span class="glyphicon glyphicon-plus"></span></a></th>
                              <th><a ng-click="removeallsubmenus()"><span class="glyphicon glyphicon-remove"></a></th>
                            </tr>
                            <tr ng-show="searchSubMenuValue">
                              <th colspan="4"><input class="form-control" ng-model="sm.submenuname" /></th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr ng-repeat="submenu in selectedmenu.submenus | filter: sm.submenuname">
                              <td>{{ submenu.submenuname }}</td>
                              <td>{{ submenu.submenulabel }}</td>
                              <td><a ng-click="editsubmenu(submenu, $index)"><span class="glyphicon glyphicon-edit"></span></a></td>
                              <td><a ng-click="removesubmenu($index)"><span class="glyphicon glyphicon-trash"></span></a></td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                    </div>                    
                    
                  </div>
                  
                </tab>
                
                <tab>
                  <tab-heading>
                    Views
                  </tab-heading>
                  <div class="panel-body">
                    
                    <div class="col-md-4">
                      
                      <script type="text/ng-template" id="viewContent.html">
                        <div class="modal-header">
                            <h3 class="modal-title">View Details</h3>
                        </div>
                        <div class="modal-body">
                          <div class="form-group">
                            <label for="view-name">View Name</label>
                            <input ng-model="view.viewname" type="text" class="form-control" id="view-name" placeholder="" />
                          </div>                        
                          <div class="form-group">
                            <label for="view-type">View Type</label>
                            <select class="form-control" ng-model="view.viewtype" id="view-type">
                              <option value="create">Create</option>
                              <option value="edit">Edit</option>
                              <option value="list">List</option>
                              <option value="view">View</option>
                            </select>
                          </div>                            
                          <div class="form-group">
                            <label for="model-name">Model Name</label>
                            <select id="model-name" class="form-control" 
                              ng-model="view.modelname" 
                              ng-required="true" 
                              ng-options="model.name as model.name for model in view.models" />
                          </div>
                          
                          <div ng-show="view.viewtype=='list'" class="form-group">
                            <label for="menu-name">Main Menu Name</label>
                            <select id="menu-name" class="form-control" 
                              ng-model="view.menuname" 
                              ng-required="true" 
                              ng-options="menu.menuname as menu.menuname for menu in view.menus">
                              <option value="">No Menu</option>
                            </select>
                          </div>                          
                        </div>
                        <div class="modal-footer">
                            <button class="btn btn-primary" ng-click="ok()">OK</button>
                            <button class="btn btn-warning" ng-click="cancel()">Cancel</button>
                        </div>
                      </script>
                      
                      <div class="table">
                        <table class="table table-hover">
                          <thead>
                            <tr>
                              <th>View  <a ng-click="searchView()"><span class="glyphicon glyphicon-search"></span></a></th>
                              <th><a ng-click="newview()"><span class="glyphicon glyphicon-plus"></span></a></th>
                              <th><a ng-click="deleteallviews()"><span class="glyphicon glyphicon-trash"></span></a></th>
                            </tr>
                            <tr ng-show="searchViewValue">
                              <th colspan="3"><input class="form-control" ng-model="v.viewname" /></th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr ng-repeat="view in project.views | filter: v.viewname">
                              <td ng-click="selectView(view, $index)">{{ view.viewname }}<span class="badge">{{ view.controls.length }}</span></td>
                               <td><a ng-click="openview(view, $index)"><span class="glyphicon glyphicon-edit"></span></a></td>
                              <td><a ng-click="deleteview($index)"><span class="glyphicon glyphicon-trash"></span></a></td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                    </div>
                    <div class="col-md-8">
                      <script type="text/ng-template" id="controlContent.html">
                        <div class="modal-header">
                            <h3 class="modal-title">Control Details</h3>
                        </div>
                        <div class="modal-body">
                          <div class="row">
                            <div class="col-md-4 form-group">
                              <label for="control-name">Control Name</label>
                              <input ng-model="control.controlname" type="text" class="form-control" id="control-name" placeholder="Name" />
                            </div>
                            <div class="col-md-2 form-group">
                              <label for="control-type">Control Type</label>
                              <select class="form-control" ng-model="control.controltype">
                                <option value="Text">Text</option>
                                <option value="Number">Number</option>
                                <option value="Lookup">Lookup</option>
                                <option value="Date">Date</option>
                              </select>
                            </div>
                            <div class="col-md-2 form-group">
                              <label for="control-width">Width</label>
                              <input ng-model="control.width" type="number" class="form-control" id="control-width" placeholder="2" />
                            </div>
                            <div class="col-md-4 form-group">
                              <label for="model-element">Model Element</label>
                              <input ng-model="control.modelelement" type="text" class="form-control" id="model-element" placeholder="" />
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-md-4 form-group">
                              <label for="control-label">Control Label</label>
                              <input ng-model="control.controllabel" type="text" class="form-control" id="control-label" placeholder="Display Name" />
                            </div>
                            <div class="col-md-4 form-group">
                              <label for="example-text">Sample text</label>
                              <input ng-model="control.exampletext" type="text" class="form-control" id="example-text" placeholder="" />
                            </div>
                          </div>
                        </div>
                        <div class="modal-footer">
                            <button class="btn btn-primary" ng-click="ok()">OK</button>
                            <button class="btn btn-warning" ng-click="cancel()">Cancel</button>
                        </div>
                      </script>
                      
                      <script type="text/ng-template" id="copyControls.html">
                        <div class="modal-header">
                            <h3 class="modal-title">Select View</h3>
                        </div>
                        <div class="modal-body">
                          <div class="form-group">
                            <label for="view-name">View Name</label>
                            <select id="view-name" class="form-control" 
                              ng-model="view" 
                              ng-required="true" 
                              ng-options="view.viewname for view in views" />
                          </div>
                        </div>
                        <div class="modal-footer">
                            <button class="btn btn-primary" ng-click="ok()">OK</button>
                            <button class="btn btn-warning" ng-click="cancel()">Cancel</button>
                        </div>
                      </script>
                      
                      <div class="table">
                        <table class="table table-hover">
                          <thead>
                            <tr>
                              <th>Control Name  <a ng-click="searchControl()"><span class="glyphicon glyphicon-search"></span></a></th>
                              <th>Type</th>
                              <th>Label <a ng-click="copycontrols()"><span class="glyphicon glyphicon-import"></span></a></th>
                              <th><a ng-click="newcontrol()"><span class="glyphicon glyphicon-plus"></span></a></th>
                              <th><a ng-click="removeallcontrols()"><span class="glyphicon glyphicon-remove"></span></a></th>
                            </tr>
                            <tr ng-show="searchControlValue">
                              <th colspan="5"><input class="form-control" ng-model="c.controlname" /></th>
                            </tr>                            
                          </thead>
                          <tbody>
                            <tr ng-repeat="control in selectedView.controls | filter: c.controlname">
                              <td>{{ control.controlname }}</td>
                              <td>{{ control.controltype }}</td>
                              <td>{{ control.controllabel }}</td>
                              <td><a ng-click="editcontrol(control, $index)"><span class="glyphicon glyphicon-edit"></span></a></td>
                              <td><a ng-click="removecontrol($index)"><span class="glyphicon glyphicon-trash"></span></a></td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </div>
                <!-- tab panel body div close-->

                </tab>                 
                
              </tabset>                  
            </div>
              
          </div>
          
          <div class="col-md-3">
          
            <div class="form-group">
              <label for="project-name">Project Name</label>
              <input type="text" ng-model='project.name' class="form-control" id="project-name" placeholder="Project Name" required />
            </div>             
            <div class="form-group">
              <label for="jsonfile">JSON File</label>
              <input type="file" on-read-file="displayFileContents(contents)" />
              <p>
              <a class="btn btn-primary" ng-click="saveJSON()" ng-href="{{ url }}">Export JSON</a>
              <a class="btn btn-primary" ng-click="viewJSON()">View JSON</a>
              </p>
            </div>          
            
            <!-- <textarea ng-model="projects" rows="10"></textarea> -->
            <pre ng-show="viewJSONValue">{{ project | json}}</pre>              
            
          </div>
        
        </div>
        
      </fieldset>
      
    </form>
    
  </div>
  
</div>